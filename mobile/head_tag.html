<script
  type="text/x-handlebars"
  data-template-name="components/mobile-category-topic"
>
  {{#user-link user=topic.last_poster}}
      {{avatar topic.last_poster imageSize="medium"}}
  {{/user-link}}
  {{raw "topic-status" topic=topic}}
  <a class='title' href="{{unbound topic.lastUnreadUrl}}">{{{unbound topic.fancyTitle}}}</a>
  {{topic-post-badges newPosts=topic.totalUnread unseen=topic.unseen url=topic.lastUnreadUrl}}

  {{#if latestTopicOnly}}
    <div class='last-user-info'>
      {{i18n 'categories.latest_by'}} <a href="{{{unbound topic.lastPosterUrl}}}">{{unbound topic.last_poster.username}}</a>
      <a href="{{unbound topic.lastPostUrl}}">{{format-age topic.last_posted_at}}</a>
    </div>
  {{else}}
    <a href="{{unbound topic.lastPostUrl}}" class="last-posted-at">{{format-age topic.last_posted_at}}</a>
  {{/if}}
</script>

<script type="text/x-handlebars" data-template-name="app/assets/javascripts/discourse/app/components/parent-category-row.hbs">
{{#unless this.isHidden}}
  <PluginOutlet
    @name="category-list-above-each-category"
    @outletArgs={{hash category=this.category}}
  />

  <tr
    data-category-id={{this.category.id}}
    data-notification-level={{this.category.notificationLevelString}}
    class="{{if
        this.category.description_excerpt
        'has-description'
        'no-description'
      }}
      {{if this.category.uploaded_logo.url 'has-logo' 'no-logo'}}"
  >
    <td
      class="category
        {{if this.isMuted 'muted'}}
        {{if this.noCategoryStyle 'no-category-style'}}"
      style={{unless
        this.noCategoryStyle
        (category-color-variable this.category.color)
      }}
    >
      <CategoryTitleLink @category={{this.category}} />
      <PluginOutlet
        @name="below-category-title-link"
        @connectorTagName="div"
        @outletArgs={{hash category=this.category}}
      />

      {{#if this.category.description_excerpt}}
        <div class="category-description">
          {{dir-span this.category.description_excerpt htmlSafe="true"}}
        </div>
      {{/if}}

      {{#if this.category.isGrandParent}}
        <table class="category-list subcategories-with-subcategories">
          <tbody>
            {{#each this.category.subcategories as |subcategory|}}
              <SubCategoryRow
                @category={{subcategory}}
                @listType={{this.listType}}
              />
            {{/each}}
          </tbody>
        </table>
      {{else if this.category.subcategories}}
        <div class="subcategories">
          {{#each this.category.subcategories as |subcategory|}}
            <SubCategoryItem
              @category={{subcategory}}
              @listType={{this.listType}}
            />
          {{/each}}
        </div>
      {{/if}}
    </td>

    <td class="topics">
      <div title={{this.category.statTitle}}>{{html-safe
          this.category.stat
        }}</div>
      <CategoryUnread
        @category={{this.category}}
        @tagName="div"
        @class="unread-new"
        @unreadTopicsCount={{this.unreadTopicsCount}}
        @newTopicsCount={{this.newTopicsCount}}
      />
    </td>

    {{#unless this.isMuted}}
      {{#if this.showTopics}}
        <td class="latest">
          {{#each this.category.featuredTopics as |t|}}
            <FeaturedTopic @topic={{t}} />
          {{/each}}
        </td>
      {{/if}}
    {{/unless}}
  </tr>
{{/unless}}
</script>